gomi.dll

ごみばこを空にします。

オプション達

  -e, --empty           ごみ箱を空にする(デフォルト)
                        成功時 1 、失敗時 0 を返す。
  -n, --number-of-items ごみの数。Reference0 にごみ箱の使用容量(バイト)
  -V, --version         バージョン

ごみ箱を空にするとき専用オプション達

  -a, --asynchronous    非同期にごみ捨て
  -f, --force           確認ダイアログ出ない
  -q, --quiet           プログレスバー出ない
  -s, --silent          効果音出ない
  -v, --verbose         プログレスバー出る (デフォルト)
  -w, --hwnd=HWND       通知先ウィンドウハンドル

  -a の時は -w のウィンドウに Direct SSTP Notify で OnRecycleBinEmptied を送ります。

使用例

dicGomi.txt に里々用のサンプルがあります。
他の栞の人は適宜苦労してください。

謝辞のようなもの
  らくちゃん、ジェニファー、ねこ達。使ってくれてありがとう。
  あなた方のおかげで改良する気が起きました。

次回予告
  ごみ箱にファイルを捨てられたら便利だろうか。 SHFileOperation でぐぐれ。
  -w 無しでも DSSTP を送れるようにしよう。 FMO を見ればいいらしい。

おまけ
  連続するオプションは一つにまとめられます。
  すなわち、-a -f -s なら -afs でもOK。

  長いオプションも使えます。
  -a の代わりに --asynchronous とか。

  -q と -v を両方指定すると、後に来たほうが優先されます。
  （gomi,-q,-v,-q,-q,-v）なんてのも平気。

  gomi.dll じゃあんまりなので何か可愛らしい名前を考えてください。

既知の問題
  確認ダイアログで「いいえ」を押しても成功扱いになってしまっている。
  直さねばなりませんね。

ライセンス
  GPL です。うわー。ソースはこのへんから入手できますよ。
  <http://da.pekori.to/npw/saori/>
